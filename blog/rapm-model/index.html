<!DOCTYPE html> <html lang="en"> <head> <meta charset="UTF-8"> <!-- Enable responsiveness on mobile devices--> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- CSS --> <link rel="stylesheet" href="/assets/css/main.css"> <!-- Icons --> <!-- <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png"> --> <!-- <link rel="shortcut icon" href="/public/favicon.ico"> --> <link rel="shortcut icon" href="/favicon.ico?"> <!-- RSS (well, actually Atom) --> <link type="application/atom+xml" rel="alternate" href="https://jecutter.github.io/feed.xml" title="Jacob Cutter" /> <!-- Twitter Card and OpenGraph Tags --> <!-- Begin Jekyll SEO tag v2.6.1 --> <title>An RAPM Model to Assess NBA Players | Jacob Cutter</title> <meta name="generator" content="Jekyll v3.8.5" /> <meta property="og:title" content="An RAPM Model to Assess NBA Players" /> <meta name="author" content="Jacob Cutter" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Developing a lineup-independent NBA player impact model using ridge regression techniques on play-by-play data." /> <meta property="og:description" content="Developing a lineup-independent NBA player impact model using ridge regression techniques on play-by-play data." /> <link rel="canonical" href="https://jecutter.github.io/blog/rapm-model/" /> <meta property="og:url" content="https://jecutter.github.io/blog/rapm-model/" /> <meta property="og:site_name" content="Jacob Cutter" /> <meta property="og:image" content="https://jecutter.github.io/files/rapm_model/steph_mccaw.jpg" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2020-03-28T00:00:00-07:00" /> <meta name="twitter:card" content="summary_large_image" /> <meta property="twitter:image" content="https://jecutter.github.io/files/rapm_model/steph_mccaw.jpg" /> <meta property="twitter:title" content="An RAPM Model to Assess NBA Players" /> <meta name="twitter:site" content="@jecutter92" /> <meta name="twitter:creator" content="@jecutter92" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"Jacob Cutter"},"image":"https://jecutter.github.io/files/rapm_model/steph_mccaw.jpg","description":"Developing a lineup-independent NBA player impact model using ridge regression techniques on play-by-play data.","dateModified":"2020-03-28T00:00:00-07:00","datePublished":"2020-03-28T00:00:00-07:00","headline":"An RAPM Model to Assess NBA Players","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://jecutter.github.io/blog/rapm-model/"},"url":"https://jecutter.github.io/blog/rapm-model/","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://jecutter.github.io/files/Cutter-6690_cropped.jpg"},"name":"Jacob Cutter"},"@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> <!-- Google Analytics --> <script> window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date; ga('create', 'UA-162130749-1', 'auto'); ga('send', 'pageview'); </script> <script async src='https://www.google-analytics.com/analytics.js'></script> <!-- MathJax --> <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script> </head> <body class="themed"> <aside role="complementary" class="sidebar"> <div class="sidebar-portrait"> <img src="/files/Cutter-6690_cropped.jpg" alt="Portrait of Jacob Cutter"/> </div> <div class="container sidebar-sticky"> <div class="sidebar-about"> <div class="site-title"> <a href="/" title="Home">Jacob Cutter</a> </div> <p class="lead"></p> </div> <nav role="navigation" class="sidebar-nav"> <a class="sidebar-nav-item" href="/">Home</a> <a class="sidebar-nav-item" href="/blog/">Project Portfolio</a> <a class="sidebar-nav-item" href="/papers/">Publications and Talks</a> <!-- Adding a link to my resume --> <!-- <a class="sidebar-nav-item" href="/files/jacob_cutter_resume_3_13_2020.pdf">Resume</a> --> <!-- <a class="sidebar-nav-item" href="/files/jacob_cutter_resume_6_11_2020.pdf">Resume</a> --> <!-- <a class="sidebar-nav-item" href="/files/Jacob_Cutter_Resume_9_11_2020.pdf">Resume</a> --> <!-- <a class="sidebar-nav-item" href="/files/Jacob_Cutter_Resume_3_18_2021.pdf">Resume</a> --> <!-- <a class="sidebar-nav-item" href="/files/Jacob_Cutter_Resume_2_15_2022.pdf">Resume</a> --> <a class="sidebar-nav-item" href="/files/Jacob_Cutter_Resume_12_2_2022.pdf">Resume</a> </nav> <small> <!-- &copy; <time datetime="2015-12-31T16:00:00-08:00">2016</time>–<time datetime="2022-12-08T10:39:46-08:00">2022</time>. All rights reserved. --> &copy; 2022. All rights reserved. <br> <!-- <a class="legal" href="/privacy-policy/">Privacy Policy</a> --> </small> </div> </aside> <main role="main" class="content container"> <article role="article" class="post"> <h1 class="post-title">An RAPM Model to Assess NBA Players</h1> <time datetime="2020-03-28T00:00:00-07:00" class="post-date">March 28, 2020</time> <p>If you are like me, you watch NBA basketball games with a healthy mixture of enthusiasm for the game and skepticism of the media-driven narratives. In the last several years, I noticed a wide variety of advanced stats being thrown around by fans and media members alike, seemingly to justify their biased conclusions about players with highly subjective analysis. What’s more, these stats are frequently used as definitive arguments for end-of-season awards, such as MVP.</p> <p>You hear things like: “Player X is clearly superior to Player Y because he ranks higher in categories A, B, and C.” Inevitably, you hear the response: “We all know stats A, B, and C don’t necessarily translate to winning games!”</p> <p>Even with such advanced stats, there is sometimes widespread disagreement about a player’s impact or value. There are multiple issues at play with these stats:</p> <ol> <li>They are heavily influenced by simple box score stats, some of which have arguable relevance to a player’s overall impact.</li> <li>Many of them are generated using historical data, biasing more recent evaluations.</li> <li>They are often taken out of applicable context (perhaps due to lack of transparency).</li> </ol> <p>Below, I will discuss my own attempt to “objectively” assess player impact by creating a RAPM model and compare those results with existing stats. However, some words are in order about the existing landscape of advanced stats.</p> <h2 id="player-impact-metrics">Player Impact Metrics</h2> <p>To get a broad survey of existing methodologies, let’s take a look at just some of the most popular advanced player stats that exist (follow the links to get a more detailed description):</p> <ul> <li><a href="https://www.basketball-reference.com/about/per.html">Hollinger’s Player Efficiency Rating (PER)</a> <!-- * [Justin Kubatko's Win Shares (WS)](https://www.basketball-reference.com/about/ws.html) --></li> <li><a href="https://squared2020.com/2017/09/18/deep-dive-on-regularized-adjusted-plus-minus-i-introductory-example/">Plus-Minus/Adjusted Plus-Minus/RAPM</a></li> <li><a href="https://www.basketball-reference.com/about/bpm2.html">Box Plus-Minus (BPM), by Daniel Myers</a> <!-- * [Player Tracking Plus-Minus (PT-PM) by Andrew Johnson](https://fansided.com/2016/09/08/player-tracking-plus-minus-2015-2016/) --></li> <li><a href="https://www.espn.com/nba/story/_/id/10740818/introducing-real-plus-minus">ESPN’s Real Plus-Minus (RPM), by Jeremias Engelmann</a></li> <li><a href="https://www.bball-index.com/player-impact-plus-minus/">Player Impact Plus-Minus (PIPM), by Jacob Goldstein of BBall Index</a></li> </ul> <p>Such player impact stats can be roughly categorized as follows: purely box score–based stats, Statistical Plus-Minus (SPM) models, and actual Plus-Minus models (usually based on RAPM).</p> <p>PER belongs to the first category. It is an all-in-one stat which uses a fixed formula to give a measure of player production from simple box score stats (e.g. points, rebounds, assists, turnovers, steals, blocks, personal fouls). While PER succeeds in combining box score stats into a single number, there are <a href="https://thezscore.com/2016/02/17/the-definitive-per-criticism/">plenty of criticisms surrounding its methodology and biases</a>.</p> <p>BPM falls into the category of SPM models. While it is also based on box score stats, it is a regression against historical RAPM datasets to determine the coefficients which weight each feature (RAPM, a variant of plus-minus, will be discussed below). In other words, SPM models are linear estimators of RAPM.</p> <p>It is easy to see why box score–based stats are limited; this can’t possibly encompass the entirety of a player’s impact! Consider some of the things not taken into account by simple box score stats:</p> <ul> <li>Man-on-man and help defense</li> <li>Screen-setting to open up shooters</li> <li>Player gravity (drawing the defense)</li> <li>Floor spacing (threat of deep 3-point shooting)</li> <li>Quality of passing (<em>not</em> the same as the rate of assists or turnovers)</li> <li>Intangibles (e.g. leadership, communication on defense, etc.) <!--Is grabbing a defensive rebound over your teammate more valuable than setting a screen that opens up a shot for Stephen Curry? If a blocked shot goes right back to the opposing team for a put-back, is that block more valuable than solid man-on-man defense? --></li> </ul> <p>We would like to capture a player’s intangibles, or anything that is not shown by the box score. Plus-Minus based stats may be used for this purpose, since they are based purely on overall team success when the player is on the floor. The advanced stats we have not yet discussed, RPM and PIPM, are both based on RAPM, which is a successor of Plus-Minus. Let’s take a deeper look at what this means, and why this technique is so prominent in basketball analytics.</p> <h2 id="what-is-regularized-adjusted-plus-minus">What is Regularized Adjusted Plus-Minus?</h2> <p>The original <strong>Plus-Minus</strong> stat is simply the point differential a team experiences when a player is on the floor (i.e. points scored by the team minus points scored against the team). However, it is well-established that this metric is deceptive, since a player surrounded by highly skilled teammates will have an inflated Plus-Minus.</p> <p>To answer this, an <strong>Adjusted Plus-Minus (APM)</strong> was created to account for these effects. This essentially means creating a <script type="math/tex">n \times m</script> matrix <script type="math/tex">X</script> of <em>n</em> possessions by <em>m</em> players involved in all those possessions. We can set entries to <script type="math/tex">1</script> if the player is on offense in the possession, <script type="math/tex">-1</script> if on defense, and <script type="math/tex">0</script> if not on the floor. We can then formulate a matrix equation to solve for the coefficients <script type="math/tex">\beta</script> that give the resulting point differentials <script type="math/tex">Y</script>:</p> <script type="math/tex; mode=display">Y = X \beta \\ X^T Y = X^T X \beta \\ \beta = (X^T X)^{-1} X^T Y</script> <p>We then approximate the <script type="math/tex">\beta</script> coefficients by solving for the <strong>least-squares solution</strong> to the matrix equation. This yields <script type="math/tex">\beta</script> values which actually represent the player contributions, removing the effect of teammates and opposing players.</p> <p>These coefficients are the player APM values. However, because of multicollinearity, the results have enormous variance. Luckily, there is a statistical technique for dealing with this very issue: <strong>L2 regularization</strong>, or <strong>ridge regression</strong>. This is a well-known method for penalizing outlier values back to the central value, to reduce variance at the expense of bias.</p> <p>Ridge regression is performed by modifying the least squares formulation with a diagonal perturbation matrix <script type="math/tex">\lambda I</script>:</p> <script type="math/tex; mode=display">\beta = (X^T Y + \lambda I)^{-1} X^T Y</script> <p>The <script type="math/tex">\lambda</script> value is a model hyperparameter that must be tuned to stabilize the <script type="math/tex">\beta</script> coefficients. Note that in the limit that <script type="math/tex">\lambda \to 0</script>, we recover least squares; in the limit <script type="math/tex">\lambda \to \infty</script>, <script type="math/tex">\beta</script> shrinks to <script type="math/tex">0</script>.</p> <p>In this case, the resulting <script type="math/tex">\beta</script> coefficients are the RAPM values, or the <strong>Regularized Adjusted Plus-Minus</strong> for each player. To be clear, these values <em>are not absolute points added</em>. This regularization technique results in coefficients that are scaled by a factor dependent on <script type="math/tex">\lambda</script>. The RAPM values should therefore be taken as a relative stat, or a differential contribution.</p> <p>Circling back, how do our advanced stats incorporate RAPM? SPM models like BPM use RAPM <em>strictly as an input</em> to find the model coefficients. RPM and PIPM, on the other hand, are essentially “enhanced” RAPM models which use <strong>Bayesian priors</strong> to constrain the <script type="math/tex">\beta</script> coefficients based on a fit to historical RAPM datasets. As we will discuss, this puts a potentially biased emphasis on box score stats.</p> <h2 id="harvesting-matchups-from-play-by-play-data">Harvesting Matchups from Play-by-Play Data</h2> <p>In order to create my own RAPM model, I constructed a matrix <script type="math/tex">X</script> as explained above, as well as the point differential resulting from each row (each <em>matchup stint</em>). I performed the following procedure:</p> <ul> <li>Scrape play-by-play data from all NBA games over several seasons</li> <li>Parse the PBP data into <em>stints</em>, or matchups between player lineups (that may last a number of possessions)</li> <li>Calculate the point differential resulting from each stint, and from that the <script type="math/tex">Y</script> array (which is actually the plus-minus per 100 possessions)</li> <li>Create a matrix <script type="math/tex">X</script> with <script type="math/tex">n</script> stints (rows) and <script type="math/tex">m</script> NBA players (columns)</li> </ul> <p>To scrape the data, I used a Selenium web driver in Python to parse play-by-play data from <a href="https://stats.nba.com/game/0021600001/playbyplay/">NBA.com</a>. These tables track the score and provide raw text data for analyzing the content of each play. In addition, the starting lineup for each quarter was fetched separately, allowing for player rotations to be tracked throughout a game. This is crucial for monitoring which lineups are out on the floor at any time.</p> <p>The full scraping and wrangling codes can be <a href="https://github.com/jecutter/nba-data-models">found at my Github</a>.</p> <figure> <a href="/files/rapm_model/example_stint_table.png"> <img src="/files/rapm_model/example_stint_table.png" alt="A figure with a caption" /> </a> <figcaption>An example table of lineup matchup stints as a Pandas dataframe. Note that the raw point differential, number of possessions for each stint, and plus-minus per 100 possessions are shown.</figcaption> </figure> <p>Once we’ve isolated each matchup, we can parse the lineups into individual players for the home and away teams. Since we are taking the results of a stint, rather than single possessions, each team has been on both offense and defense. Therefore, we give home team players a matrix entry of <script type="math/tex">1</script>, away team players an entry of <script type="math/tex">-1</script>, and players not on the floor an entry of <script type="math/tex">0</script>. We then take <script type="math/tex">Y</script> to be the home team plus-minus per 100 possessions.</p> <p>This can be done with a Python function as shown below:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">GenerateMatchupMatrix</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">player_list</span><span class="p">):</span>
    <span class="n">matchup_plus_minus</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">rapm_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">player_list</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">idx</span><span class="o">=</span><span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">stint</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">idx</span><span class="o">%</span><span class="mi">100</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">"</span><span class="se">\r</span><span class="s">On Stint </span><span class="si">%</span><span class="s">i..."</span> <span class="o">%</span> <span class="p">(</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        
        <span class="n">matchup_plus_minus</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stint</span><span class="o">.</span><span class="n">ht_pm_ph</span><span class="p">)</span>

        <span class="n">f_ht_p</span><span class="p">,</span> <span class="n">f_allp_ind</span><span class="p">,</span> <span class="n">f_htl_ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">intersect1d</span><span class="p">(</span><span class="n">player_list</span><span class="p">,</span> <span class="n">stint</span><span class="o">.</span><span class="n">ht_lineup</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">','</span><span class="p">),</span> <span class="n">return_indices</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">rapm_matrix</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="n">f_allp_ind</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">f_vt_p</span><span class="p">,</span> <span class="n">f_allp_ind</span><span class="p">,</span> <span class="n">f_vtl_ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">intersect1d</span><span class="p">(</span><span class="n">player_list</span><span class="p">,</span> <span class="n">stint</span><span class="o">.</span><span class="n">vt_lineup</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">','</span><span class="p">),</span> <span class="n">return_indices</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">rapm_matrix</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="n">f_allp_ind</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

        <span class="n">idx</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">print</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s"> Finished!'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rapm_matrix</span><span class="p">,</span> <span class="n">matchup_plus_minus</span>
</code></pre></div></div> <p>Once we have <script type="math/tex">X</script> and <script type="math/tex">Y</script>, we can build a ridge regression model to estimate the coefficients <script type="math/tex">\beta</script>.</p> <h2 id="developing-a-ridge-regression-model">Developing a Ridge Regression Model</h2> <p>In order to optimize our ridge regression model, we will use the matchup matrix <script type="math/tex">X</script> and matchup point differential <script type="math/tex">Y</script> as our training data and perform <em>k</em>-fold cross-validation to use the training data itself for validation. This is important, since we have only 3 seasons of NBA data (2017-2019).</p> <p>In Python, we use the <code class="language-plaintext highlighter-rouge">Ridge</code> model from scikit-learn along with the <code class="language-plaintext highlighter-rouge">GridSearchCV</code> method to perform cross-validation on a comprehensive set of <script type="math/tex">\lambda</script> parameters (Note: <script type="math/tex">\lambda \equiv \alpha</script> in the <code class="language-plaintext highlighter-rouge">Ridge</code> model).</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x_train</span> <span class="o">=</span> <span class="n">rapm_matrix</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">matchup_plus_minus</span>

<span class="n">ridge_reg</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">()</span>
<span class="n">alphas</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">1500</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">3000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">]</span>
<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s">'alpha'</span><span class="p">:</span> <span class="n">alphas</span><span class="p">}</span>
<span class="n">grid_search</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">ridge_reg</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">grid_search</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">'Optimized hyperparameters:'</span><span class="p">,</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">best_params_</span><span class="p">)</span>

<span class="n">Output</span><span class="p">:</span>
<span class="o">&gt;&gt;</span> <span class="n">Optimized</span> <span class="n">hyperparameters</span><span class="p">:</span> <span class="p">{</span><span class="s">'alpha'</span><span class="p">:</span> <span class="mi">1500</span><span class="p">}</span>
</code></pre></div></div> <p>While <em>k</em>-fold cross-validation is typically used to set <script type="math/tex">\lambda</script>, we can also make sense of our choice by plotting the calculated RAPM as a function of <script type="math/tex">\lambda</script>.</p> <p>It is clear that the <script type="math/tex">\beta</script> values for small <script type="math/tex">\lambda</script> are highly unstable, as certain players experience a lot of variance. We can see that for our optimized <script type="math/tex">\lambda</script> parameter, the best– and worst–RAPM players are stable and begin to converge to the mean.</p> <figure> <a href="/files/rapm_model/rapm_model_tuning.png"> <img src="/files/rapm_model/rapm_model_tuning.png" alt="Plot showing the tuning of the ridge regression lambda parameter." /> </a> <figcaption>A plot showing the regularization of player RAPM ratings as a function of lambda. On the right, we see the tightening of the correlation between RAPM and raw player +/- as lambda is increased.</figcaption> </figure> <p>We therefore tune our hyperparameter with some degree of confidence. It is important to point out that our typical notion of out-of-sample model testing is compromised here; season-to-season variation in player performance is an unavoidable reality (for numerous reasons), and this model is meant to produce a <em>descriptive</em> stat rather than a <em>predictive</em> one. But more on that later.</p> <h2 id="evaluating-player-rapm-ratings">Evaluating Player RAPM Ratings</h2> <p>Let’s take a look at how various players fare in RAPM.</p> <p>Along with play-by-play data, individual stats were scraped for NBA players, including net rating, BPM, and RPM (again, see my <a href="https://github.com/jecutter/nba-data-models">Github</a>). Note that <em>net rating</em> is actually just the player’s raw plus-minus per 100 possessions, which doesn’t take into account the caliber of a player’s supporting cast.</p> <p>Below, we see the top 10 and bottom 10 players in RAPM (of players averaging <script type="math/tex">> 20</script> minutes per game), along with these other metrics.</p> <figure> <a href="/files/rapm_model/ordered_players_rapm.png"> <img src="/files/rapm_model/ordered_players_rapm.png" alt="A figure with a caption" /> </a> <figcaption></figcaption> </figure> <!-- It is clear that some players with great RAPM also have a high net rating, but this is not always the case. While there is overall correlation, we have to account for the fact that strengths/deficiencies are sometimes masked by context. --> <p>Stephen Curry has league-leading RAPM over the last 3 years, which is not outlandish given that he is a transformative player of this era. It is more interesting that the top 5 players are <em>all</em> guards – smaller players, 3 of whom are considered excellent 2-way players and all of whom can shoot 3-pointers and make plays for others. Notice also that some players, especially Damian Lillard and Jrue Holiday, are highly underrated by ESPN’s RPM.</p> <p>If you are a basketball fan, I know you may scoff at the fact that Jrue Holiday is ranked “better” than LeBron James over a 3 year span. My response to this: the reasons you have for <em>assuming</em> LeBron James would have a better regular season RAPM may be very biased. If you take away LeBron James’s:</p> <ul> <li>Usage rate and time spent with the ball in his hands</li> <li>Previous accomplishments (prior to 2017)</li> <li>Playoff performances (we are only looking at the <em>regular season</em>)</li> <li>Media narratives</li> <li>“Flashiness”</li> </ul> <p>it is not so far-fetched. Think about it: Jrue Holiday is young, plays both ends of the floor, is an efficient scorer and play-maker, and has largely played a complementary role without an outstanding supporting cast. I’m not here to argue that Jrue Holiday is better than LeBron James in general, however the purpose of this exercise is to remove biased assumptions.</p> <p>On the other hand, the players with the worst RAPM tend to be either aging, inexperienced, or considered lazy on at least one end of the floor. For instance, Trae Young is a rookie considered to be one of the worst defenders in the league.</p> <p>An important note: I am by no means claiming these RAPM ratings are perfect or the end-all-be-all. These will of course have error, but still may provide some interesting unbiased perspective when evaluating players.</p> <h2 id="comparing-with-other-advanced-stats">Comparing with Other Advanced Stats</h2> <p>To understand what we’ve calculated better, and how it relates to existing metrics, we can examine correlations with a variety of box score and advanced stats.</p> <p>A useful tool for doing this is to make a Pearson correlation heatmap. This allows us to examine relationships between a large number of features and potentially informs us on what dependencies to examine further.</p> <figure> <a href="/files/rapm_model/pearson_correlation_rapm.png"> <img src="/files/rapm_model/pearson_correlation_rapm.png" alt="Plot showing Pearson correlation of RAPM with other advanced stats." /> </a> <figcaption></figcaption> </figure> <p>Shown in the matrix above are correlations between various player statistics averaged over the 2017-2019 seasons, including the previously discussed PER, BPM, RPM, and RAPM (within the green lines). The other abbreviated stats are: true shooting %, field goal attempts per 100 possessions, free throw rate, opponent field goal %, assist-to-turnover ratio, rebound rate, blocks per 100 poss., and steals per 100 poss.</p> <p>We can summarize some interesting points from this table:</p> <ul> <li>PER has a much higher correlation with field goal attempts than the other stats (it rewards players who simply take more shots)</li> <li>PER, BPM, and RPM all have a slight correlation with player height, while RAPM is completely uncorrelated with height</li> <li>PER, BPM, and RPM give much more weight to rebounds and blocks than RAPM (but interestingly, not steals)</li> <li>RAPM is the most anticorrelated with opponent field goal %, which serves as a proxy for man-on-man defense (which is hard to quantify)</li> <li>RAPM is less correlated with true shooting % than the other stats, though this is also true for the free throw rate (and free throws factor in to true shooting)</li> <li>PER and RPM are more correlated with BPM than RAPM</li> </ul> <p>Taking all these observations together, it is reasonable to conclude that</p> <ol> <li>Other advanced stats appear to favor big men, including stats that are typical for big men (e.g. rebounds and blocks)</li> <li>ESPN’s RPM, one of the most popular and quoted advanced stats, appears to be highly dependent on box score stats</li> </ol> <p>The explanation for this is that the RPM methodology uses box score priors calculated from a historical 15-year RAPM dataset (a cursory overview of such a technique is given in <a href="https://fansided.com/2018/01/11/nylon-calculus-introducing-player-impact-plus-minus/">this article about PIPM</a>). These <strong>Bayesian priors</strong> are then used in the ridge regression to constrain the range of <script type="math/tex">\beta</script> for various players, thus pre-estimating their value using their box score stats. While these priors are proprietary and not publicly available, it appears that the box score component is significant (and even <a href="https://cornerthreehoops.wordpress.com/tag/rapm/">such factors as height and age are directly included</a>).</p> <h2 id="conclusions">Conclusions</h2> <p>At the beginning of this article, I provided 3 criticisms of current player impact metrics. Let’s discuss how my RAPM ratings address each:</p> <ol> <li>Box score dependence – there is none, not even assumed box score priors.</li> <li>Historical bias – RAPM in this context is calculated from only a 3-year dataset, providing sufficient statistics without biasing regression models to a completely different era of basketball.</li> <li>Context – as I will make clear, my RAPM model is <em>not</em> intended to be predictive, but is a fair assessment of player impact over the games included.</li> </ol> <p>After comparing with these other metrics, let me define RAPM as follows: <em>the relative ability of a player to positively influence possessions, regardless of their box score numbers, usage, or position</em>. This is meant to be a <em>descriptive</em> stat over selected seasons, and thus no attempt is made to develop box score priors to improve the season-to-season accuracy.</p> <p>This exercise to create a minimally-biased player ranking is informative when comparing to the publicly available advanced stats, because it shows just how subjective these models are. In Bayesian statistics, it is common to employ Bayesian priors to constrain results. However, the choice of these priors and selection of features is subjective and somewhat defeats the strength of the RAPM method: to measure a player’s overall impact and intangibles. If man-on-man defense is considered less valuable than a block, if a rebound is given more weight than a well-executed pass, and a taller player is given the edge over a shorter one, then our model loses its context-independence.</p> <p>The true power of metrics like ESPN’s RPM is its <em>predictive</em> power. By regressing against a very large RAPM dataset to calculate priors, it can then predict a player’s future RAPM with better accuracy. However, RPM is often used as a <em>descriptive</em> stat to explain why a particular player has the edge in the current season, though RPM is tuned on box score stats from other seasons which don’t necessarily reflect their current impact. This inevitably leads to underestimating over-achievers and vice versa.</p> <p>As a descriptive stat, pure RAPM models may still be the most objective. It may not accurately tell us what impact a player will have next season, but yet again, can any stat do that reliably given unavoidable year-to-year variations (coaching change, team change, injuries, etc.)? No all-in-one stat gives a perfect player assessment, however we must be careful about how we apply any of these advanced stats and clearly state our assumptions.</p> </article> <!-- Share Buttons --> <aside role="complementary" class="sharing"> <!-- The Buttons --> <ul class="rrssb-buttons clearfix"> <!-- Facebook --> <li class="rrssb-facebook"> <a href="https://www.facebook.com/sharer/sharer.php?u=https://jecutter.github.io/blog/rapm-model/" class="popup"> <span class="rrssb-icon"> <svg xmlns="https://www.w3.org/2000/svg" viewBox="0 0 29 29"><path d="M26.4 0H2.6C1.714 0 0 1.715 0 2.6v23.8c0 .884 1.715 2.6 2.6 2.6h12.393V17.988h-3.996v-3.98h3.997v-3.062c0-3.746 2.835-5.97 6.177-5.97 1.6 0 2.444.173 2.845.226v3.792H21.18c-1.817 0-2.156.9-2.156 2.168v2.847h5.045l-.66 3.978h-4.386V29H26.4c.884 0 2.6-1.716 2.6-2.6V2.6c0-.885-1.716-2.6-2.6-2.6z"/></svg> </span> <span class="rrssb-text">Facebook</span> </a> </li> <!-- Twitter --> <li class="rrssb-twitter"> <a href="https://twitter.com/intent/tweet?text=An+RAPM+Model+to+Assess+NBA+Players&amp;via=jecutter92&amp;url=https://jecutter.github.io/blog/rapm-model/" class="popup"> <span class="rrssb-icon"> <svg xmlns="https://www.w3.org/2000/svg" viewBox="0 0 28 28"><path d="M24.253 8.756C24.69 17.08 18.297 24.182 9.97 24.62a15.093 15.093 0 0 1-8.86-2.32c2.702.18 5.375-.648 7.507-2.32a5.417 5.417 0 0 1-4.49-3.64c.802.13 1.62.077 2.4-.154a5.416 5.416 0 0 1-4.412-5.11 5.43 5.43 0 0 0 2.168.387A5.416 5.416 0 0 1 2.89 4.498a15.09 15.09 0 0 0 10.913 5.573 5.185 5.185 0 0 1 3.434-6.48 5.18 5.18 0 0 1 5.546 1.682 9.076 9.076 0 0 0 3.33-1.317 5.038 5.038 0 0 1-2.4 2.942 9.068 9.068 0 0 0 3.02-.85 5.05 5.05 0 0 1-2.48 2.71z"/></svg> </span> <span class="rrssb-text">Twitter</span> </a> </li> <!-- LinkedIn --> <li class="rrssb-linkedin"> <!-- Replace href with your meta and URL information --> <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://jecutter.github.io/blog/rapm-model/&amp;title=An+RAPM+Model+to+Assess+NBA+Players&amp;summary=Developing+a+lineup-independent+NBA+player+impact+model+using+ridge+regression+techniques+on+play-by-play+data.%0A&amp;source=AlexGude.com" class="popup"> <span class="rrssb-icon"> <svg xmlns="https://www.w3.org/2000/svg" viewBox="0 0 28 28"><path d="M25.424 15.887v8.447h-4.896v-7.882c0-1.98-.71-3.33-2.48-3.33-1.354 0-2.158.91-2.514 1.802-.13.315-.162.753-.162 1.194v8.216h-4.9s.067-13.35 0-14.73h4.9v2.087c-.01.017-.023.033-.033.05h.032v-.05c.65-1.002 1.812-2.435 4.414-2.435 3.222 0 5.638 2.106 5.638 6.632zM5.348 2.5c-1.676 0-2.772 1.093-2.772 2.54 0 1.42 1.066 2.538 2.717 2.546h.032c1.71 0 2.77-1.132 2.77-2.546C8.056 3.593 7.02 2.5 5.344 2.5h.005zm-2.48 21.834h4.896V9.604H2.867v14.73z"/></svg> </span> <span class="rrssb-text">LinkedIn</span> </a> </li> <!-- RRSSB Scripts --> <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script> <script> window.jQuery || document.write('<script src="js/vendor/jquery.1.10.2.min.js"><\/script>') </script> <script src="/public/js/rrssb.min.js"></script> </ul> </aside> <!-- Related and Recent Posts --> <!-- Related Posts --> <aside role="complementary" class="related"> <h2>Related Posts</h2> <div class="card-grid"> <div class="card-element card-image"> <a href="/blog/player-comp/"> <img src="/files/player_comp/imgonline-com-ua-twotoone-Xzq8ZtqJyh.jpg" alt="Default image for player comparison project. "> </a> </div> <div class="card-element card-text"> <a href="/blog/player-comp/"> <strong>Comp The Player: Classifying NBA Players</strong> </a> <br> Performing informative NBA player comparisons to assess style of play using Random Forest classification. </div> </div> </aside> </main> <script> window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date; ga('create', 'UA-162130749-1', 'auto'); ga('send', 'pageview'); </script> <script async src='https://www.google-analytics.com/analytics.js'></script> </body> </html>
